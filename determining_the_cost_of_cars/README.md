# Определение стоимости автомобилей


## Используемые инструменты

`python` `pandas` `numpy` `matplotlib`, `seaborn`, `sklearn` `lightgbm` `catboost`

## Ход исследования

* Обоснование актуальности выбранной темы
* Определение объекта и предмета исследования
* Постановка цели и конкретных задач
* Разработка гипотезы
* Выбор методов решения поставленных задач
* Проведение исследования
* Обработка результатов исследования
* Формулирование выводов и оценка полученных результатов
* Оформление работы

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 

**Цель проекта** – подготовить прототип модели машинного обучения, определяющий стоимость автомобиля по его характеристикам со значением метрики *RMSE * менее 2500.

**Задачи:**

1. Составить план работы.
2. Уточнить задачу.
3. Разработать модель.
4. Подготовить отчёт.

### Описание данных

**Признаки**

- `DateCrawled` — дата скачивания анкеты из базы
- `VehicleType` — тип автомобильного кузова
- `RegistrationYear` — год регистрации автомобиля
- `Gearbox` — тип коробки передач
- `Power` — мощность (л. с.)
- `Model` — модель автомобиля
- `Kilometer` — пробег (км)
- `RegistrationMonth` — месяц регистрации автомобиля
- `FuelType` — тип топлива
- `Brand` — марка автомобиля
- `Repaired` — была машина в ремонте или нет
- `DateCreated` — дата создания анкеты
- `NumberOfPictures` — количество фотографий автомобиля
- `PostalCode` — почтовый индекс владельца анкеты (пользователя)
- `LastSeen` — дата последней активности пользователя

**Целевой признак**

- `Price ` — цена (евро)

## Вывод

Было проведено исследование, позволившее построить модель для задачи регрессии, которая прогнозирует рыночную стоимость автомобиля. Входные данные – данные о технических характеристиках, комплектации и ценах других автомобилей.

Изучение файла с данными и исследовательский анализ данных показали необходимость предобработки. Пропущенные значения и аномалии были заполнены и устранены соответственно. Также из датасета были удалены признаки, не несущие информацию для предсказания. На этапе предобработки было потеряно 4.65 % наблюдений от исходных данных.

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1. Для моделей `CatBoostRegressor` и `LGBMRegressor` использовались встроенные кодировщики, для `LGBMRegressor` предварительно потребовалось приведение категориальных признаков к типу *category*.

Упомянутые выше модели были построены и обучены с помощью рандомизированного поиска по гиперпараметрам. В результате по критериям качества предсказания и скорости обучения наилучшей оказалась модель **`LightGBM` с *RMSE* = 1575.03 евро, временем обучения 50.10 с и временем предсказания 0.83 с**.

Адекватность построенных моделей подтвердилась путем сравнения с работой константной модели `DummyRegressor`, ***RMSE***  которой составила **4497.70 евро**.

Окончательная проверка качества модели `LightGBM` на тестовой выборке показала значение ***RMSE* 1551.12 евро**.
