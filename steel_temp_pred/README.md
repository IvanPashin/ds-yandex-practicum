# Промышленность - предсказание температуры сплава



## Используемые инструменты

 `python` `pandas` `numpy` `matplotlib` `seaborn` `sklearn` `lightgbm` `catboost`

## Ход исследования

* Определение объекта и предмета исследования
* Постановка цели и конкретных задач
* Разработка гипотезы
* Выбор методов решения поставленных задач
* Проведение исследования
* Обработка результатов исследования
* Формулирование выводов и оценка полученных результатов
* Оформление работы

## Описание проекта

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Ваша задача — построить модель, которая будет предсказывать температуру этого сплава.

**Цель проекта** – подготовить прототип модели машинного обучения, определяющий температуру сплава по его характеристикам со значением метрики *MAE* менее 6.8.

### Шаги

1. Составить план работы.
2. Уточнить задачу.
3. Разработать модель.
4. Подготовить отчёт.

### Описание данных

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша. 


Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).


Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.


Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).
Данные состоят из файлов, полученных из разных источников:

- `data_arc_new.csv` — данные об электродах;
- `data_bulk_new.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time_new.csv` — данные о подаче сыпучих материалов (время);
- `data_gas_new.csv` — данные о продувке сплава газом;
- `data_temp_new.csv` — результаты измерения температуры;
- `data_wire_new.csv` — данные о проволочных материалах (объём);
- `data_wire_time_new.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

- `key` – номер партии стали (во всех файлах).

Таблица `data_arc_new`:

- `Начало нагрева дугой` – дата и время начала нагрева дугой,
- `Конец нагрева дугой` – дата и время конца нагрева дугой,
- `Активная мощность` – активная электрическая мощность потребляемая нагревателем,
- `Реактивная мощность` – реактивная электрическая мощность потребляемая нагревателем.

Таблица `data_bulk_new`:

- `Bulk 1` - `Bulk 15` – объем добавок сыпучих материалов, для каждой партии (15 признаков).

Таблица `data_bulk_time_new`:

- `Bulk 1` - `Bulk 15` – дата и время подачи сыпучих материалов, для каждой партии (15 признаков).

Таблица `data_gas_new`:

- `Газ 1` – объем поданного газа.

Таблица `data_temp_new`:

- `Время замера` – дата и время замера температуры,
- `Температура` – температура сплава.

Таблица `data_wire_new`:

- `Wire 1` - `Wire 9` – объем добавок проволочных материалов, для каждой партии (9 признаков).

Таблица `data_wire_time_new`:

- `Wire 1` - `Wire 9` – дата и время подачи проволочных материалов, для каждой партии (9 признаков).


## Вывод

При изучении файлов с данными не выявлено явных дубликатов. В целевой переменной были обнаружены пропуски (эти объекты были удалены). В данных о добавленных веществах обнаружены константные признаки (удалены) и признаки, содержащие более 90% пропусков (удалены), пропуски для остальных веществ заполнены нулевым значением. Для данных о нагреве был сгенерирован новый признак - количество активной энергии, потраченной на нагрев и коэффициент мощности, характеризующий тип электрической нагрузки. Некоторые колонки требовали изменения типа данных. Данные были объеденены в один датафрейм, в котором остались только те партии стали, информация о которых присутствует во всех таблицах.
Разведочный анализ данных оценить связь между признаками. 

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1. Так как датафрейме все признаки количественные, к ним было применено масштабирование (`StandardScaler` и `MinMaxScaler`), если этого требовал соответствующий алгоритм обучения. В качестве моделей обучения использовались `LinearRegression`, `Ridge`, `Lasso`, `CatBoostRegressor`, `LGBMRegressor` и `RandomForestRegressor`

Упомянутые выше модели были построены и обучены с помощью рандомизированного поиска по сетке гиперпараметров. В результате по критерю максимизации метрики качества *MAE* наилучшей оказалась модель `CatBoostRegressor` с ***MAE* = 6.39**.

Окончательная проверка качества модели `CatBoostRegressor` на тестовой выборке показала значение ***MAE* = 6.22**. Адекватность построенных моделей подтвердилась путем сравнения с работой константной модели `DummyRegressor`, **MAE***  которой составила **8.13**.
