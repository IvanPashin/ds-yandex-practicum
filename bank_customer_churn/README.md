# Прогнозирование оттока клиентов банка



## Используемые инструменты

`python` `pandas` `numpy` `matplotlib` `seaborn` `sklearn`

## Ход исследования

* Обоснование актуальности выбранной темы
* Определение объекта и предмета исследования
* Постановка цели и конкретных задач
* Разработка гипотезы
* Выбор методов решения поставленных задач
* Проведение исследования
* Обработка результатов исследования
* Формулирование выводов и оценка полученных результатов
* Оформление работы

## Описание проекта

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

**Цель проекта** – подготовить прототип модели машинного обучения, предсказывающей уйдёт клиент от оператора связи в ближайшее время или нет. Требуется построить модель со значением метрики *AUC-ROC* не менее 0.59.

### Шаги

- загрузить и подготовить данные,
- обучить разные модели и найти лучшую,
- провести финальное тестирование,
- сформулировать общий вывод.

### Описание данных

В нашем распоряжении исторические данные о поведении клиентов и расторжении договоров с банком.

* `RowNumber` — индекс строки в данных,
* `CustomerId` — уникальный идентификатор клиента,
* `Surname` — фамилия,
* `CreditScore` — кредитный рейтинг,
* `Geography` — страна проживания,
* `Gender` — пол,
* `Age` — возраст,
* `Tenure` — сколько лет человек является клиентом банка,
* `Balance` — баланс на счёте,
* `NumOfProducts` — количество продуктов банка, используемых клиентом,
* `HasCrCard` — наличие кредитной карты,
* `IsActiveMember` — активность клиента,
* `EstimatedSalary` — предполагаемая зарплата,
* `Exited` — факт ухода клиента.

## Вывод

Было проведено исследование, позволившее построить модель для задачи классификации, которая прогнозирует, уйдёт клиент из банка в ближайшее время или нет. Входные данные – данные о поведении клиентов и расторжении договоров с банком.

При изучении файла с данными не выявлено аномалий и существенных выбросов в признаках. В колонке `tenure` были обработаны пропущенные значения и изменен тип данных. Из датасета были удалены три признака, не несущие информацию для предсказания.

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1 с учетом дисбаланса классов в целевом признаке.

Были рассмотрены 3 алгоритма обучения – градиентный бустинг, случайный лес и логистическая регрессия. В результате наилучшей оказалась модель CatBoostClassifier, с AUC-ROC - 0.87.
- гипрепараметры модели – `max_depth=4`, `n_estimators=830`, `learning_rate=0.03`

Окончательная проверка качества моделей на тестовой выборке показала значение AUC-ROC - 0.87.
